Search.setIndex({"docnames": ["README", "index", "notes_gradient", "ot_markov_distances", "ot_markov_distances.discounted_wl", "ot_markov_distances.sinkhorn", "ot_markov_distances.utils", "ot_markov_distances.wl"], "filenames": ["README.rst", "index.rst", "notes_gradient.rst", "ot_markov_distances.rst", "ot_markov_distances.discounted_wl.rst", "ot_markov_distances.sinkhorn.rst", "ot_markov_distances.utils.rst", "ot_markov_distances.wl.rst"], "titles": ["ot_markov_distances", "Welcome to ot_markov_distances\u2019s documentation!", "Notes on Gradient computation", "ot_markov_distances package", "ot_markov_distances.discounted_wl module", "ot_markov_distances.sinkhorn module", "ot_markov_distances.utils module", "ot_markov_distances.wl module"], "terms": {"distanc": [0, 1, 3, 4, 5, 6, 7], "graph": [0, 1, 6], "base": [0, 1, 5], "optim": [0, 1], "transport": [0, 1], "thi": [0, 1, 2, 3, 4, 5, 6], "i": [0, 1, 2, 3, 4, 5, 6], "implement": [0, 1, 2, 3, 4, 5], "code": [0, 1], "brug\u00e8r": [0, 1, 2], "et": [0, 1, 2, 5, 6], "al": [0, 1, 2, 5, 6], "bww23": [0, 1, 2, 3], "bruger": [0, 1], "t": [0, 1, 2, 6], "wan": [0, 1], "z": [0, 1], "wang": [0, 1], "y": [0, 1, 2], "2023": [0, 1], "markov": [0, 1, 3, 4, 6, 7], "chain": [0, 1, 3, 6], "Their": [0, 1, 3], "differenti": [0, 1, 3, 5], "arxiv": [0, 1], "ab": [0, 1], "2302": [0, 1], "08621": [0, 1], "The": [0, 1, 4, 5], "main": [0, 1, 6], "branch": [0, 1], "us": [0, 1, 2, 3, 4, 5], "cuda11": [0, 1], "8": [0, 1], "its": [0, 1, 3, 4, 6], "If": [0, 1, 3, 4, 5], "some": [0, 1, 2], "reason": [0, 1, 5], "you": [0, 1], "need": [0, 1, 2], "cuda12": [0, 1], "clone": [0, 1], "instead": [0, 1, 2, 3, 4, 5], "packag": [0, 1], "manag": [0, 1], "via": [0, 1], "poetri": [0, 1], "recommend": [0, 1], "instal": [0, 1], "otherwis": [0, 1, 6], "prefer": [0, 1], "them": [0, 1], "manual": [0, 1], "list": [0, 1, 6], "avail": [0, 1], "file": [0, 1], "pyproject": [0, 1], "toml": [0, 1], "when": [0, 1], "have": [0, 1, 3, 4, 5], "can": [0, 1, 2, 4, 5], "add": [0, 1], "our": [0, 1], "makefil": [0, 1], "make": [0, 1, 6], "dep": [0, 1], "directli": [0, 1], "doc": [0, 1], "contain": [0, 1, 3, 4], "gener": [0, 1], "after": [0, 1], "type": [0, 1, 3, 4], "build": [0, 1], "html": [0, 1], "readthedoc": [0, 1], "format": [0, 1], "sourc": [0, 1], "jupyt": [0, 1], "notebook": [0, 1], "util": [0, 1, 3], "helper": [0, 1], "reusabl": [0, 1], "librari": [0, 1], "comput": [0, 1, 3, 4, 5, 7], "discount": [0, 1, 3, 4], "wl": [0, 1, 3, 4, 6], "discounted_wl": [0, 1, 3], "py": [0, 1, 6], "__init__": [0, 1], "sinkhorn": [0, 1, 3, 4, 6, 7], "function": [0, 1, 3, 4, 5, 6], "chen": [0, 1, 6], "staticdoc": [0, 1], "static": [0, 1, 5], "test": [0, 1], "saniti": [0, 1], "check": [0, 1, 3, 4, 5], "do": [0, 1, 2, 5], "edit": [0, 1], "folder": [0, 1], "wipe": [0, 1], "everi": [0, 1, 3, 5, 6], "time": [0, 1], "built": [0, 1], "part": [0, 1], "altern": [0, 1], "onli": [0, 1, 2, 3, 4, 5], "requir": [0, 1], "develop": [0, 1, 2], "done": [0, 1], "dev": [0, 1], "found": [0, 1], "directori": [0, 1], "see": [0, 1, 3, 4, 5, 6], "barycent": [0, 1], "coarsen": [0, 1], "ipynb": [0, 1], "note": [1, 5], "gradient": [1, 3, 5], "submodul": 1, "modul": 1, "sinkhorn_dist": [1, 3], "wl_k": [1, 3, 7], "markov_measur": [1, 3, 6], "discounted_wl_infti": [1, 3, 4], "discounted_wl_k": [1, 3, 4], "index": [1, 6], "search": 1, "page": 1, "tristan": 1, "zhengchao": 1, "yusu": 1, "clm": [1, 6], "22": [1, 6], "samantha": 1, "sunhyuk": 1, "lim": 1, "facundo": 1, "m\u00e9moli": 1, "weisfeil": 1, "l": [1, 2, 6], "ehman": 1, "meet": 1, "g": [1, 2, 5, 6], "romov": 1, "w": 1, "asserstein": 1, "In": 1, "intern": 1, "confer": 1, "machin": 1, "learn": 1, "icml": 1, "3371": 1, "3416": 1, "pmlr": 1, "2022": 1, "fsejournev": [1, 5], "19": [1, 5], "jean": 1, "feydi": 1, "thibault": 1, "\u00e9": [1, 5], "journ": 1, "fran": 1, "\u00e7": 1, "oi": 1, "xavier": 1, "vialard": 1, "shun": 1, "ichi": 1, "amari": 1, "alain": 1, "trouv": 1, "gabriel": 1, "peyr": [1, 5], "interpol": 1, "between": [1, 3, 4, 7], "mmd": 1, "diverg": [1, 5], "22nd": 1, "artifici": 1, "intellig": 1, "statist": 1, "2681": 1, "2690": 1, "2019": 1, "peyrec": [1, 5], "marco": 1, "cuturi": 1, "other": [1, 5], "applic": 1, "data": 1, "scienc": 1, "foundat": 1, "trend": 1, "11": 1, "5": [1, 6], "6": 1, "355": 1, "607": 1, "we": [2, 5, 6], "techniqu": 2, "describ": [2, 5], "But": 2, "push": 2, "formula": [2, 3, 4], "littl": 2, "further": 2, "simplifi": 2, "remark": 2, "notat": 2, "paper": [2, 3, 4], "denot": 2, "begin": [2, 6], "gather": 2, "k": [2, 3, 4, 5, 6, 7], "i_": 2, "nm": 2, "1": [2, 3, 4, 5, 6, 7], "delta": [2, 3, 4], "p": [2, 5], "left": 2, "delta_": 2, "ij": [2, 6], "kl": 2, "right": 2, "_": [2, 6], "leq": [2, 6], "n": [2, 3, 4, 5, 6, 7], "j": [2, 6], "m": [2, 3, 4, 5, 6, 7], "gamma": 2, "gamma_": 2, "kk": 2, "theta": 2, "theta_": 2, "ll": 2, "text": [2, 5, 6], "where": [2, 6], "frac": 2, "partial": 2, "c": [2, 3, 5, 6], "epsilon": [2, 3, 5, 6], "infti": [2, 3, 4], "c_": 2, "setx": 2, "seti": 2, "end": [2, 6], "also": [2, 6], "o_": 2, "loss": 2, "x_": 2, "y_": 2, "Then": 2, "matrix": [2, 3, 4, 5, 6], "ie": 2, "dimens": [2, 3, 4, 6, 7], "codim": 2, "flatten": 2, "togeth": 2, "o": 2, "x": 2, "f": [2, 5], "thu": 2, "save": 2, "appli": 2, "abov": 2, "onc": 2, "torch": [2, 3, 4, 5, 6, 7], "solv": 2, "inv": 2, "more": [2, 6], "effici": 2, "stabil": 2, "call": [2, 6], "k_tm1_grad": 2, "explicitli": 2, "l_": 2, "1_": 2, "kj": 2, "And": [2, 6], "similarli": 2, "discounted_wl_infty_cost_matrix": [3, 4], "sinkhorn_intern": [3, 5], "forward": [3, 4, 5], "backward": [3, 4, 5], "weighted_transition_matrix": [3, 6], "double_last_dimens": [3, 6], "draw_markov": [3, 6], "degree_markov": [3, 6], "densifi": [3, 6], "dummy_densifi": [3, 6], "cost_matrix_index": [3, 6], "reindex_cost_matrix": [3, 6], "re_project_c": [3, 6], "pad_one_markov_to": [3, 6], "pad_markov": [3, 6], "wl_k_spars": [3, 7], "tensor": [3, 4, 5, 6, 7], "b": [3, 4, 5, 6, 7], "float": [3, 4, 5, 6, 7], "max_it": [3, 4, 5], "int": [3, 4, 5, 6, 7], "100": [3, 4, 5], "check_convergence_interv": [3, 5], "0": [3, 4, 5, 6, 7], "cv_atol": [3, 5], "0001": [3, 5], "cv_rtol": [3, 5], "1e": [3, 4, 5], "05": [3, 5], "return_has_converg": [3, 5], "liter": [3, 5], "true": [3, 5, 6], "fals": [3, 4, 5, 6], "pytorch": [3, 5], "batch": [3, 4, 5, 6, 7], "over": [3, 4, 5, 6, 7], "It": [3, 5, 6], "compat": [3, 5], "autograd": [3, 4, 5], "document": [3, 5], "detail": [3, 5], "paramet": [3, 4, 5, 6, 7], "vector": [3, 5], "first": [3, 4, 5, 7], "distribut": [3, 4, 5, 6, 7], "second": [3, 4, 5, 7], "distribt": [3, 5], "cost": [3, 4, 5, 6], "regularis": [3, 5], "term": [3, 5], "max": [3, 5], "number": [3, 4, 5, 6, 7], "iter": [3, 4, 5], "default": [3, 4, 5], "converg": [3, 4, 5], "never": [3, 5], "apart": [3, 5], "from": [3, 5, 6], "last": [3, 5, 6], "reach": [3, 5], "earli": [3, 5], "algorithm": [3, 4, 5], "return": [3, 5, 6], "absolut": [3, 4, 5], "rel": [3, 4, 5], "toler": [3, 4, 5], "convereg": [3, 5], "criterion": [3, 4, 5], "whether": [3, 4, 5], "boolean": [3, 5], "indic": [3, 5, 6], "ha": [3, 5], "set": [3, 5], "mean": [3, 5], "alwai": [3, 5], "regardless": [3, 5], "valu": [3, 4, 5, 7], "result": [3, 5, 6], "mx": [3, 4, 6, 7], "my": [3, 4, 6, 7], "l1": [3, 4, 7], "none": [3, 4, 6, 7], "l2": [3, 4, 7], "cost_matrix": [3, 4, 7], "mux": [3, 4, 7], "mui": [3, 4, 7], "reg": [3, 4, 7], "sinkhorn_paramet": [3, 4, 7], "dict": [3, 4, 7], "two": [3, 4, 7], "transit": [3, 4, 6, 7], "matric": [3, 4, 6, 7], "repres": [3, 4, 7], "label": [3, 4, 7], "space": [3, 4, 7], "step": [3, 4, 5, 7], "stationari": [3, 4, 6, 7], "omit": [3, 4, 7], "recomuput": [3, 7], "regular": [3, 4, 5, 7], "take": [3, 6], "output": [3, 6], "so": [3, 4, 5, 6], "distance_matrix": [3, 4], "4": [3, 4], "sinkhorn_reg": [3, 4], "01": [3, 4], "50": [3, 4], "convergence_threshold_rtol": [3, 4], "005": [3, 4], "convergence_threshold_atol": [3, 4], "06": [3, 4], "sinkhorn_it": [3, 4], "sinkhorn_iter_schedul": [3, 4], "10": [3, 4], "x_is_spars": [3, 4], "bool": [3, 4, 5], "y_is_spars": [3, 4], "infin": [3, 4], "factor": [3, 4], "todo": [3, 4], "descript": [3, 4], "initi": [3, 4], "maximum": [3, 4], "allclos": [3, 4], "acceler": [3, 4], "consid": [3, 4], "spars": [3, 4, 6, 7], "degre": [3, 4], "lower": [3, 4], "2": [3, 4, 6], "3": [3, 4, 5], "return_differ": [3, 4], "doe": [3, 4, 5], "pass": [3, 4, 5], "mention": [3, 4], "becaus": [3, 4], "valid": [3, 4], "case": [3, 4, 6], "allow": [3, 4, 5], "specifi": [3, 4], "distrubut": [3, 4], "depth": 4, "version": [4, 5, 7], "wl_reg_infti": 4, "wl_reg_k": 4, "provid": 5, "method": 5, "tupl": [5, 6], "same": [5, 6], "bewar": 5, "shortcut": 5, "still": 5, "though": 5, "log_p": 5, "has_converg": 5, "returen": 5, "class": 5, "arg": 5, "kwarg": 5, "ctx": 5, "feydyinterpolatingoptimaltransport2019": 5, "properti": 5, "dim": 5, "broadcast": 5, "each": 5, "oper": 5, "should": 5, "fast": 5, "gpu": 5, "ot": 5, "grad_output": 5, "fact": 5, "primal": 5, "solut": 5, "dual": 5, "ar": [5, 6], "respect": 5, "input": [5, 6], "mu_x": 5, "mu_i": 5, "u": [5, 6], "discourag": 5, "q": 6, "creat": 6, "lmmc": 6, "larg": 6, "inspir": 6, "one": 6, "here": 6, "http": 6, "github": 6, "com": 6, "chens5": 6, "blob": 6, "def": 6, "random": 6, "walk": 6, "probabl": 6, "stai": 6, "node": 6, "neighbor": 6, "equiprob": 6, "arrai": 6, "weight": 6, "associ": 6, "doubl": 6, "diagon": 6, "param": 6, "d": 6, "po": 6, "node_color": 6, "ax": 6, "floattensor": 6, "dens": 6, "veri": 6, "math": 6, "max_i": 6, "deg": 6, "m_i": 6, "m_": 6, "neq": 6, "maxmiz": 6, "assum": 6, "low": 6, "ldot": 6, "nonzero": 6, "increas": 6, "order": 6, "eventu": 6, "pad": 6, "less": 6, "than": 6, "give": 6, "an": 6, "size": 6, "index_mask": 6, "mask": 6, "correspond": 6, "did": 6, "actual": 6, "": 6, "just": 6, "final": 6, "m_dens": 6, "m_indic": 6, "longtensor": 6, "m_indices_mask": 6, "booltensor": 6, "dummi": 6, "full": 6, "simpli": 6, "all": 6, "mx_index": 6, "my_index": 6, "mx_mask": 6, "my_mask": 6, "reindex": 6, "go": 6, "well": 6, "precis": 6, "mx_dens": 6, "my_dens": 6, "c_index": 6, "c_mask": 6, "c_dens": 6, "view": 6, "dx": 6, "dy": 6, "invers": 6, "match": 6, "c_spars": 6, "rest": 6, "fill": 6, "zero": 6, "mu": 6, "state": 6, "ad": 6, "mass": 6, "themselv": 6, "wp": 6, "transition_matric": 6, "shape": 6}, "objects": {"": [[3, 0, 0, "-", "ot_markov_distances"]], "ot_markov_distances": [[4, 0, 0, "-", "discounted_wl"], [3, 1, 1, "", "discounted_wl_infty"], [3, 1, 1, "", "discounted_wl_k"], [3, 1, 1, "", "markov_measure"], [5, 0, 0, "-", "sinkhorn"], [3, 1, 1, "", "sinkhorn_distance"], [6, 0, 0, "-", "utils"], [7, 0, 0, "-", "wl"], [3, 1, 1, "", "wl_k"]], "ot_markov_distances.discounted_wl": [[4, 1, 1, "", "discounted_wl_infty"], [4, 1, 1, "", "discounted_wl_infty_cost_matrix"], [4, 1, 1, "", "discounted_wl_k"]], "ot_markov_distances.sinkhorn": [[5, 2, 1, "", "Sinkhorn"], [5, 1, 1, "", "sinkhorn"], [5, 1, 1, "", "sinkhorn_internal"]], "ot_markov_distances.sinkhorn.Sinkhorn": [[5, 3, 1, "", "backward"], [5, 3, 1, "", "forward"]], "ot_markov_distances.utils": [[6, 1, 1, "", "cost_matrix_index"], [6, 1, 1, "", "degree_markov"], [6, 1, 1, "", "densify"], [6, 1, 1, "", "double_last_dimension"], [6, 1, 1, "", "draw_markov"], [6, 1, 1, "", "dummy_densify"], [6, 1, 1, "", "markov_measure"], [6, 1, 1, "", "pad_markovs"], [6, 1, 1, "", "pad_one_markov_to"], [6, 1, 1, "", "re_project_C"], [6, 1, 1, "", "reindex_cost_matrix"], [6, 1, 1, "", "weighted_transition_matrix"]], "ot_markov_distances.wl": [[7, 1, 1, "", "wl_k"], [7, 1, 1, "", "wl_k_sparse"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"ot_markov_dist": [0, 1, 3, 4, 5, 6, 7], "setup": [0, 1], "depend": [0, 1], "project": [0, 1], "structur": [0, 1], "document": [0, 1], "run": [0, 1], "experi": [0, 1], "welcom": 1, "": 1, "content": [1, 3], "indic": 1, "tabl": 1, "bibliographi": 1, "note": 2, "gradient": 2, "comput": 2, "packag": 3, "submodul": 3, "modul": [3, 4, 5, 6, 7], "discounted_wl": 4, "sinkhorn": 5, "util": 6, "wl": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinxcontrib.bibtex": 9, "sphinx": 57}, "alltitles": {"ot_markov_distances package": [[3, "ot-markov-distances-package"]], "Submodules": [[3, "submodules"]], "Module contents": [[3, "module-ot_markov_distances"]], "ot_markov_distances.discounted_wl module": [[4, "module-ot_markov_distances.discounted_wl"]], "ot_markov_distances.sinkhorn module": [[5, "module-ot_markov_distances.sinkhorn"]], "ot_markov_distances.utils module": [[6, "module-ot_markov_distances.utils"]], "ot_markov_distances.wl module": [[7, "module-ot_markov_distances.wl"]], "ot_markov_distances": [[0, "ot-markov-distances"], [1, "ot-markov-distances"]], "Setup": [[0, "setup"], [1, "setup"]], "Dependencies": [[0, "dependencies"], [1, "dependencies"]], "Project structure": [[0, "project-structure"], [1, "project-structure"]], "Documentation": [[0, "documentation"], [1, "documentation"]], "Running Experiments": [[0, "running-experiments"], [1, "running-experiments"]], "Welcome to ot_markov_distances\u2019s documentation!": [[1, "welcome-to-ot-markov-distances-s-documentation"]], "Contents": [[1, null]], "Indices and tables": [[1, "indices-and-tables"]], "Bibliography": [[1, "bibliography"]], "Notes on Gradient computation": [[2, "notes-on-gradient-computation"]]}, "indexentries": {}})